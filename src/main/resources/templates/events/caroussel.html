<div class="py-5">
  <style>
    :where([class^="ri-"])::before {
      content: "\f3c2";
    }

    .carousel-slide {
      transform: translateX(100%);
      transition: transform 0.5s ease-in-out;
    }

    .carousel-slide.active {
      transform: translateX(0);
    }

    .carousel-slide.prev {
      transform: translateX(-100%);
    }

    .dot-indicator {
      transition: all 0.3s ease;
    }

    .dot-indicator.active {
      background-color: #e91e63;
      transform: scale(1.2);
    }

    .nav-button {
      transition: all 0.3s ease;
      backdrop-filter: blur(10px);
    }

    .nav-button:hover {
      background-color: rgba(233, 30, 99, 0.9);
      transform: scale(1.1);
    }
  </style>
  <div class="max-w-7xl mx-auto sm:px-6 lg:px-8">
    <div class="relative w-full max-w-6xl mx-auto">
      <div class="relative overflow-hidden rounded-sm shadow-2xl bg-white" style="aspect-ratio: 16/9;">
        <div class="relative w-full h-full">
          <a th:each="event,position : ${events}" th:href="@{/events/{eventUrl}(eventUrl=${event.eventUrl})}" th:title="${event.description}">
            <div class="carousel-slide absolute inset-0" th:classappend="${position.index == 0} ? 'active' : ''">
              <img th:src="${event.coverUrl}" th:alt="${event.description}" class="w-full h-full object-cover object-top">
              <div class="absolute inset-0 bg-gradient-to-t from-black/50 to-transparent"></div>
              <div class="absolute bottom-4 left-4 sm:bottom-8 sm:left-8 text-white">
                <h3 th:text="${event.title}" class="text-lg sm:text-2xl font-bold mb-1 sm:mb-2"></h3>
                <p th:text="${event.description}" class="text-sm sm:text-lg opacity-90"></p>
                <div class="flex flex-col sm:flex-row sm:items-center mt-2 sm:mt-3 space-y-1 sm:space-y-0 sm:space-x-4">
                  <span class="flex items-center text-xs sm:text-base">
                    <i class="ri-calendar-line mr-1 sm:mr-2 text-sm sm:text-base"></i>
                    <span th:text="${event.descriptiveDate}"></span>
                  </span>
                  <span class="flex items-center text-xs sm:text-base">
                    <i class="ri-map-pin-line mr-1 sm:mr-2 text-sm sm:text-base"></i>
                    <span th:text="${event.location}"></span>
                  </span>
                </div>
              </div>
            </div>
          </a>
        </div>
        <button class="nav-button absolute left-2 sm:left-4 top-1/2 transform -translate-y-1/2 w-10 h-10 sm:w-12 sm:h-12 bg-white/20 text-white rounded-full flex items-center justify-center" id="prevBtn">
          <i class="ri-arrow-left-line text-lg sm:text-xl"></i>
        </button>
        <button class="nav-button absolute right-2 sm:right-4 top-1/2 transform -translate-y-1/2 w-10 h-10 sm:w-12 sm:h-12 bg-white/20 text-white rounded-full flex items-center justify-center" id="nextBtn">
          <i class="ri-arrow-right-line text-lg sm:text-xl"></i>
        </button>
      </div>
      <div class="flex justify-center mt-6 space-x-3">
        <th:block th:each="event, iterStat : ${events}">
          <button class="dot-indicator w-3 h-3 rounded-full bg-gray-300" th:classappend="${iterStat.index == 0} ? 'active' : ''" th:attr="data-slide=${iterStat.index}"></button>
        </th:block>
      </div>
    </div>
  </div>
  <script id="carousel-functionality" type="text/javascript">
    document.addEventListener('DOMContentLoaded', function () {
      const slides = document.querySelectorAll('.carousel-slide');
      const dots = document.querySelectorAll('.dot-indicator');
      const prevBtn = document.getElementById('prevBtn');
      const nextBtn = document.getElementById('nextBtn');
      let currentSlide = 0;
      let autoPlayInterval;
      const updateSlides = () => {
        slides.forEach((slide, index) => {
          slide.classList.remove('active', 'prev');
          if (index === currentSlide) {
            slide.classList.add('active');
          } else if (index < currentSlide) {
            slide.classList.add('prev');
          }
        });
        dots.forEach((dot, index) => {
          dot.classList.toggle('active', index === currentSlide);
        });
      };
      const nextSlide = () => {
        currentSlide = (currentSlide + 1) % slides.length;
        updateSlides();
      };
      const prevSlide = () => {
        currentSlide = (currentSlide - 1 + slides.length) % slides.length;
        updateSlides();
      };
      const goToSlide = (index) => {
        currentSlide = index;
        updateSlides();
      };
      const startAutoPlay = () => {
        if (autoPlayInterval) {
          clearInterval(autoPlayInterval);
        }
        autoPlayInterval = setInterval(nextSlide, 5000);
      };
      const resetAutoPlay = () => {
        if (autoPlayInterval) {
          clearInterval(autoPlayInterval);
          startAutoPlay();
        }
      };
      nextBtn.addEventListener('click', () => {
        nextSlide();
        resetAutoPlay();
      });
      prevBtn.addEventListener('click', () => {
        prevSlide();
        resetAutoPlay();
      });
      dots.forEach((dot, index) => {
        dot.addEventListener('click', () => {
          goToSlide(index);
          resetAutoPlay();
        });
      });
      startAutoPlay();
    });
  </script>
  <script id="touch-gestures" type="text/javascript">
    document.addEventListener('DOMContentLoaded', function () {
      const carousel = document.querySelector('.relative.overflow-hidden');
      let startX = 0;
      let endX = 0;
      carousel.addEventListener('touchstart', (e) => {
        startX = e.touches[0].clientX;
      });
      carousel.addEventListener('touchend', (e) => {
        endX = e.changedTouches[0].clientX;
        handleSwipe();
      });
      function handleSwipe() {
        const swipeThreshold = 50;
        const diff = startX - endX;
        if (Math.abs(diff) > swipeThreshold) {
          if (diff > 0) {
            document.getElementById('nextBtn').click();
          } else {
            document.getElementById('prevBtn').click();
          }
        }
      }
    });
  </script>
</div>
